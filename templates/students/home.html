{% extends 'students/base.html' %}
{% load static %}

{% block title %}保研加分小助手{% endblock %}

{% block extra_css %}
    <link href="{% static 'CSS/students/student_dashboard.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}

    <div class="container">
        <div class="main-content">
            <!-- 页面标题和用户信息 -->
            <div class="page-header">
                <h1 class="page-title">保研加分小助手</h1>
                <div class="user-info">
                    <span class="username">{{ user.username|default:"用户名" }}</span>
                </div>
            </div>

            <!-- 功能卡片网格 -->
            <div class="features-grid">
                <!-- 成绩排名 -->
                <a href="{% url 'ranking' %}" class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h3 class="feature-title">成绩排名</h3>
                    <p class="feature-description">查看当前成绩排名和综合评分情况</p>
                </a>

                <!-- 新增加分项目 -->
                <a href="{% url 'upload' %}" class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-plus-circle"></i>
                    </div>
                    <h3 class="feature-title">新增加分项目</h3>
                    <p class="feature-description">提交新的加分项目申请</p>
                </a>

                <!-- 我的申请详情 -->
                <a href="{% url 'submissions' %}" class="feature-card">
{#                <<<<<<待整理></待整理></待整理></待整理></待整理></待整理></待整理>#}
{#                <a href="{% url 'my_applications' %}" class="feature-card">#}
                    <div class="feature-icon">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <h3 class="feature-title">我的申请详情</h3>
                    <p class="feature-description">查看和管理已提交的申请</p>
                </a>

                <!-- 查看加分细则 -->
                <a href="{% url 'rules' %}" class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-info-circle"></i>
                    </div>
                    <h3 class="feature-title">查看加分细则</h3>
                    <p class="feature-description">了解各项加分规则和标准</p>
                </a>
            </div>

            <!-- 动态信息列表区 -->
            <div class="dynamic-section">
                <div class="section-header">
                    <h2 class="section-title">动态信息列表区</h2>
                    <a href="{% url 'notifications' %}" class="view-all">
                        <span>查看全部</span>
                        <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
            
                {% if notifications %}
                    <!-- 滚动容器 -->
                    <div class="pending-scroll-container" id="notificationScrollContainer">
                        <div class="pending-list" id="notificationScrollContent">
                            {% for notification in notifications %}
                            <div class="pending-item">
                                <div class="pending-info">
                                    <div class="pending-title">
                                        {% if notification.type == 'submission' %}
                                            <i class="fas fa-file-alt"></i>
                                            {{ notification.title }}
                                        {% elif notification.type == 'rule' %}
                                            <i class="fas fa-cog"></i>
                                            {{ notification.title }}
                                        {% else %}
                                            <i class="fas fa-bullhorn"></i>
                                            {{ notification.title }}
                                        {% endif %}
                                    </div>
                                    <div class="pending-content">{{ notification.content }}</div>
                                    <div class="pending-time">
                                        {{ notification.created_at|date:"Y-m-d H:i" }}
                                        {% if not notification.is_read %}
                                            <span class="new-badge">新</span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
            
                            <!-- 复制一份用于无缝滚动 -->
                            {% for notification in notifications %}
                            <div class="pending-item">
                                <div class="pending-info">
                                    <div class="pending-title">
                                        {% if notification.type == 'submission' %}
                                            <i class="fas fa-file-alt"></i>
                                            {{ notification.title }}
                                        {% elif notification.type == 'rule' %}
                                            <i class="fas fa-cog"></i>
                                            {{ notification.title }}
                                        {% else %}
                                            <i class="fas fa-bullhorn"></i>
                                            {{ notification.title }}
                                        {% endif %}
                                    </div>
                                    <div class="pending-content">{{ notification.content }}</div>
                                    <div class="pending-time">
                                        {{ notification.created_at|date:"Y-m-d H:i" }}
                                        {% if not notification.is_read %}
                                            <span class="new-badge">新</span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                {% else %}
                    <div class="dynamic-card">
                        <div class="empty-state">
                            <i class="fas fa-bell empty-icon"></i>
                            <h4 class="empty-title">暂无动态信息</h4>
                            <p class="empty-description">系统通知和动态将在这里显示</p>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
    
    <br>
    <a href="{% url 'root' %}"><span>退出登录（暂放此处）</span></a>
    
{% endblock %}